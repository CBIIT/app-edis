require('console-stamp')(console)
const {initConfiguration} = require("./src/conf");
const { getUsers } = require('./src/vdsActions')

const configuration = {
    ned_wsdl: 'https://soa.nih.gov:443/NEDPerson/V7/NEDPersonV7.serviceagent?wsdl',
    ned_wsdl_changes: '',
    ned_user: 'nci_cbiit_eng_iam',
    ned_pwd: '?wjWEjd-sdjksS[',
//    vds_cert: fs.readFileSync("./vds_cacert.pem"),
   vds_cert: Buffer.from('-----BEGIN CERTIFICATE-----\nMIIFvTCCBKWgAwIBAgIEUUe2qjANBgkqhkiG9w0BAQsFADB/MQswCQYDVQQGEwJV\nUzEYMBYGA1UEChMPVS5TLiBHb3Zlcm5tZW50MQwwCgYDVQQLEwNISFMxIjAgBgNV\nBAsTGUNlcnRpZmljYXRpb24gQXV0aG9yaXRpZXMxJDAiBgNVBAMTG0hIUy1GUEtJ\nLUludGVybWVkaWF0ZS1DQS1FMTAeFw0xNjA0MjYxOTE3MjFaFw0xOTA0MjYxOTQ3\nMjFaMHQxCzAJBgNVBAYTAlVTMRgwFgYDVQQKEw9VLlMuIEdvdmVybm1lbnQxDDAK\nBgNVBAsTA0hIUzEMMAoGA1UECxMDTklIMRAwDgYDVQQLEwdEZXZpY2VzMR0wGwYD\nVQQDExRzZXJ2aWNlcy52ZHMubmloLmdvdjCCASIwDQYJKoZIhvcNAQEBBQADggEP\nADCCAQoCggEBAL8l4NGwUuEKZ9e1ec9BQrZ7s9+QXCAqkHRHhX2EWfFIi6mycZsW\nFvJ10ElnaFCZfRK1yj9qnGiK1hyRsSIiRoHjUfABXXcxUvmO4DNFfpTwtJQU9aLH\neOtCwa2Rz6dZzmpUxt/Lk7FNJf8LGTmh4LqB58EIQBzb2lrfho9zvRu3PI8v1hL/\nqwjAqJNRGxh7v+zpIqjuUk08za3/EmSppHLVkNGJoMZgR9sP0iVbwqfh+YwMeTht\niOXmMfqP4Tqe3V44cdemo/FiJTb9v4zs0YDuWiSUglNvJWhCjb86lQbMf+AGcaEI\nv/DCr8P8NBwyt9fQ0dpvYj7lMX1jc2Op2zECAwEAAaOCAkowggJGMA4GA1UdDwEB\n/wQEAwIFoDAXBgNVHSAEEDAOMAwGCmCGSAFlAwIBAwgwgcsGCCsGAQUFBwEBBIG+\nMIG7MFIGCCsGAQUFBzAChkZodHRwOi8vaGhzcGtpY3JsLm1hbmFnZWQuZW50cnVz\ndC5jb20vQUlBL0NlcnRzSXNzdWVkVG9ISFNFbnRydXN0Q0EucDdjMCAGCCsGAQUF\nBzABhhRodHRwOi8vb2NzcC5kaGhzLmdvdjBDBggrBgEFBQcwAYY3aHR0cDovL2ho\nc3BraW9jc3AubWFuYWdlZC5lbnRydXN0LmNvbS9PQ1NQL0hIU0VudHJ1c3RDQTAd\nBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwge0GA1UdHwSB5TCB4jBAoD6g\nPIY6aHR0cDovL2hoc3BraWNybC5tYW5hZ2VkLmVudHJ1c3QuY29tL0NSTHMvSEhT\nRW50cnVzdENBLmNybDCBnaCBmqCBl6SBlDCBkTELMAkGA1UEBhMCVVMxGDAWBgNV\nBAoTD1UuUy4gR292ZXJubWVudDEMMAoGA1UECxMDSEhTMSIwIAYDVQQLExlDZXJ0\naWZpY2F0aW9uIEF1dGhvcml0aWVzMSQwIgYDVQQDExtISFMtRlBLSS1JbnRlcm1l\nZGlhdGUtQ0EtRTExEDAOBgNVBAMTB0NSTDE0OTkwHwYDVR0jBBgwFoAUTdWqJp4O\nSL7lRiz44QB0CPr2Q0QwHQYDVR0OBBYEFMJ9o2HHPO7m4Vaws8GrKCPMx6mFMA0G\nCSqGSIb3DQEBCwUAA4IBAQCClrAO0I2/DxFzjMcP0QK5X+h69W10vCxdfYrfrieJ\nSjddxPE33DmKyalwClPDue1Gbp1YFpD01f/NRk+/DdvT5JayuTRZzXfkujyuhpEX\nTLfGLuh6vpgRpYIqRvC11PdQ1LVYOm4ZI3VgURQ5POC9kNlIt4/8MP0zW3i24wqf\nK3DgNDxPdxsskl7xujMVHZPvn/gR8KGFB+WQ5ctpnnfr40CcB7iUvJFic8EYY2nk\nxTDRdAdPhBHps6i8f52yqEReSTPJY+oIpbcOsbADAa+vtFdp6GqF1j74GAq4yuXV\ng4XybiAjW+mEIPnnqbypPAA25yKK9ApEuuZBbWyy2vZm\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIGMDCCBRigAwIBAgITKwAAVHxEs/4H3/XUYgAAAABUfDANBgkqhkiG9w0BAQsF\nADBOMRUwEwYKCZImiZPyLGQBGRYFTE9DQUwxHDAaBgoJkiaJk/IsZAEZFgxESEhT\nU0VDVVJJVFkxFzAVBgNVBAMTDk5JSC1EUEtJLUNBLTFBMB4XDTE3MDExNzE2MjI1\nMFoXDTE5MDExNzE2MjI1MFowKDEmMCQGA1UEAxMdZGlyZWN0b3J5c2VydmljZXN0\nZXN0Lm5paC5nb3YwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDFDVr8\nimrEOxCJ1fvz9Q36KlUWUVsZyBSZQ9GxmNkiePpbOTmlO5gdz10ONmpFcVlsDW4O\nTTQCm5p8Zab1hpyIE9Ikiza3qcUWORvShgPSiGTokxeRJhtPFZVG1WW2mavftvqK\nE/sw03avMO//SCKetrHagazPZJ33NFdbYnRZpFaqbY7txaZavPy0ESneSfa0g2LY\nJPSQBcbF/DFMdKcEIBF/M9kS6jNrN+abcrMsu5/vk7JlLQWABDu3yBvIacIlpxaV\nOsYTeUcwQZESipo8H0LqPyD8kyBJ5J+DtDmeX0fDIIiF6LE2+Ij8fVlwKrjJlorC\nVo+gX8BnA+5mTSBXAgMBAAGjggMrMIIDJzA9BgkrBgEEAYI3FQcEMDAuBiYrBgEE\nAYI3FQiHscIohpH8F4b5jwiG7rxzgbudJR2Dt+ovhfXbYAIBZAIBCjAdBgNVHSUE\nFjAUBggrBgEFBQcDAgYIKwYBBQUHAwEwCwYDVR0PBAQDAgWgMCcGCSsGAQQBgjcV\nCgQaMBgwCgYIKwYBBQUHAwIwCgYIKwYBBQUHAwEwHQYDVR0OBBYEFFVMaGiBH0dl\nK3TIkwXhNSuBG2ItMB8GA1UdIwQYMBaAFHlsOIwZ0skZB3GmEPmJ8K3QgwWTMIIB\nEgYDVR0fBIIBCTCCAQUwggEBoIH+oIH7hoHBbGRhcDovLy9DTj1OSUgtRFBLSS1D\nQS0xQSxDTj1OSUhEUEtJQ0FTVkMsQ049Q0RQLENOPVB1YmxpYyUyMEtleSUyMFNl\ncnZpY2VzLENOPVNlcnZpY2VzLENOPUNvbmZpZ3VyYXRpb24sREM9REhIU1NFQ1VS\nSVRZLERDPUxPQ0FMP2NlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3Q/YmFzZT9vYmpl\nY3RDbGFzcz1jUkxEaXN0cmlidXRpb25Qb2ludIY1aHR0cDovL05JSERQS0lDUkwu\nTklILkdPVi9DZXJ0RGF0YS9OSUgtRFBLSS1DQS0xQS5jcmwwggE5BggrBgEFBQcB\nAQSCASswggEnMIG0BggrBgEFBQcwAoaBp2xkYXA6Ly8vQ049TklILURQS0ktQ0Et\nMUEsQ049QUlBLENOPVB1YmxpYyUyMEtleSUyMFNlcnZpY2VzLENOPVNlcnZpY2Vz\nLENOPUNvbmZpZ3VyYXRpb24sREM9REhIU1NFQ1VSSVRZLERDPUxPQ0FMP2NBQ2Vy\ndGlmaWNhdGU/YmFzZT9vYmplY3RDbGFzcz1jZXJ0aWZpY2F0aW9uQXV0aG9yaXR5\nMEEGCCsGAQUFBzAChjVodHRwOi8vTklIRFBLSUNSTC5OSUguR09WL0NlcnREYXRh\nL05JSC1EUEtJLUNBLTFBLmNydDArBggrBgEFBQcwAYYfaHR0cDovL05JSERQS0lP\nQ1NQLk5JSC5HT1Yvb2NzcDANBgkqhkiG9w0BAQsFAAOCAQEAoCPV65ihUbUzP8zK\nBzRH2TFQ4xO2ZTgQQZq9BgrxWNsbynbV7d55nDAeVCU/1aMXN68EwrnVLeLN72va\nCw3S7ECWtF+7zd/1N24tcK1Ack88fSv1HdTuQb+r+TQkQ4y1TVbSZioDIawQPTnf\nKUXb7Lq4ZFvuI0zF/LfpcXMimLuWs5xvMg+CYNvEOEzlSXjLO0Ur1fBw8haID5uJ\nNXxZAefJdxp+6MXBchQjWD05pckAlDJUCgasCnhu8GinTUVDEkR27p4Hg6fE1rzC\nS+uWbv2/O5GuokWAOyAN1am7jZ0V8AiBVD8Uk21P9rOE3cmSceZKMddh27w86ddY\nZnFVcw==\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIHcjCCBVqgAwIBAgITJgAAAAlbVfeQ7bWtmwAAAAAACTANBgkqhkiG9w0BAQsF\nADA2MQswCQYDVQQGEwJVUzEMMAoGA1UEChMDTklIMRkwFwYDVQQDExBOSUgtRFBL\nSS1ST09ULTFBMB4XDTE1MDkxODE4NTg0MFoXDTI1MDkxODE5MDg0MFowTjEVMBMG\nCgmSJomT8ixkARkWBUxPQ0FMMRwwGgYKCZImiZPyLGQBGRYMREhIU1NFQ1VSSVRZ\nMRcwFQYDVQQDEw5OSUgtRFBLSS1DQS0xQTCCASIwDQYJKoZIhvcNAQEBBQADggEP\nADCCAQoCggEBAMYoNp1S+pY74IrUZPCCmV0x3AkoUfJ3U1wI/rA5jYvhbjy7fN4u\n1J5JvYh3Lxw47MVfQYGZqz5rXdssSnXzsPrda9mCzJAt1s3oFU2oNhPfV2xOuw1x\n4HHJeOVNGld6IKmQZyywS9VzICtV3leKzpIaCNzFkuUUxqHheJfGLmfc5WGFYR9L\nVNQvGXpclXEay0JBEQy8wYoUVLRGqbxYPndwZqKSj6QdhAcjz43UmtgGp9qGN+BO\nBUdzJOzZmizoW16VdnWW/DrWFtnleQF0AhLMPjJdQ2ulUle+oWzlWGNh9ScNoRak\nqpWa2O4ycGJd3Dt0BkGr2FxMERQ1ikDfnRsCAwEAAaOCA18wggNbMBAGCSsGAQQB\ngjcVAQQDAgEAMB0GA1UdDgQWBBR5bDiMGdLJGQdxphD5ifCt0IMFkzCBkAYDVR0g\nBIGIMIGFMIGCBgxghkgBZQMCAQ0FAQIwcjBIBggrBgEFBQcCAjA8HjoATgBJAEgA\nIABDAFAAUwAgAFAAbwBsAGkAYwB5ACAAUwB0AGEAdABlAG0AZQBuAHQAIABUAGUA\neAB0MCYGCCsGAQUFBwIBFhpodHRwOi8vc21hcnRjYXJkLk5JSC5HT1YvADAZBgkr\nBgEEAYI3FAIEDB4KAFMAdQBiAEMAQTALBgNVHQ8EBAMCAYYwEgYDVR0TAQH/BAgw\nBgEB/wIBADAfBgNVHSMEGDAWgBRSOFPqHFu6wZd2w20dSYG7DTr0pDCCARYGA1Ud\nHwSCAQ0wggEJMIIBBaCCAQGggf6GgcJsZGFwOi8vL0NOPU5JSC1EUEtJLVJPT1Qt\nMUEsQ049TklIREtQS0lSQ0EsQ049Q0RQLENOPVB1YmxpYyUyMEtleSUyMFNlcnZp\nY2VzLENOPVNlcnZpY2VzLENOPUNvbmZpZ3VyYXRpb24sREM9REhIU1NlY3VyaXR5\nLERDPWxvY2FsP2NlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3Q/YmFzZT9vYmplY3RD\nbGFzcz1jUkxEaXN0cmlidXRpb25Qb2ludIY3aHR0cDovL05JSERQS0lDUkwuTklI\nLkdPVi9DZXJ0RGF0YS9OSUgtRFBLSS1ST09ULTFBLmNybDCCARwGCCsGAQUFBwEB\nBIIBDjCCAQowgbYGCCsGAQUFBzAChoGpbGRhcDovLy9DTj1OSUgtRFBLSS1ST09U\nLTFBLENOPUFJQSxDTj1QdWJsaWMlMjBLZXklMjBTZXJ2aWNlcyxDTj1TZXJ2aWNl\ncyxDTj1Db25maWd1cmF0aW9uLERDPURISFNTZWN1cml0eSxEQz1sb2NhbD9jQUNl\ncnRpZmljYXRlP2Jhc2U/b2JqZWN0Q2xhc3M9Y2VydGlmaWNhdGlvbkF1dGhvcml0\neTBPBggrBgEFBQcwAoZDaHR0cDovL05JSERQS0lDUkwuTklILkdPVi9DZXJ0RGF0\nYS9OSUhES1BLSVJDQV9OSUgtRFBLSS1ST09ULTFBLmNydDANBgkqhkiG9w0BAQsF\nAAOCAgEAjdq0fy4NdNJ9nmcEp7oolrvtSiZZuMmFE1DWCEIeP5PXcAf4dnEBXcrA\nS47ZXbUFkgFUccFTejIIh31a8Da2bdSM243K8lOTYprC+Vaqgy3pTnbZ1kdeyzDb\nILhsBiytMf5zGddNDWnN2Cikzzl+sqDAtUJO3lW8Cd93HUGKCtyroJChXvKqYFEm\nnONkH835b9o1XLa1S6yhZe7cAZa5SFN+DDk4+IaUwa/qCAgbTDq/0OEtdfWOL1Q4\nnNTzwJ+cNBSZNboxug7MYl9CJFPKCZmf33VS132FsU0oEuhPNPDmkkHBEId2Ni0L\nvZ4+KVQcbTQRJ+y71pT+QUoykJQHBYptHH84lerRNQ0yrFQtVSLoewGWOwNtvQ+j\nOhglgGq8TY6yrDxZbZuUDIIKN/LKv35/7YGWF7NHcBHFidflK1QBv8mYKpnVtsOJ\ncaLd2CMmYAXDCheXlisVvbGCY+tMDUWP8/PC9wMcV9O+hI15ek/pygvNyWh260Vp\n3mUT1Viqr25U9A28zOK9xB8SbVPCzh3LYbGAie81+G7tbVDd8nKEM+hoKmqX1h9b\nBYuma1MLh31lodBX7kxq9xQjYKiAIudesIcFn1UIyxIq1smldFYcEdtOw+nSVmx+\nan+Fy3g752IYDijK/71fVpdnkZIsTRtHSBEOkvCQ8ZlXGdCM2bU=\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\n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\nH7TZPbA+zMPpoy3VxsczwrwjWg==\n-----END CERTIFICATE-----\n\n', 'utf-8'),
    vds_dn: 'cn=nci_cbiit_eng_iam,ou=serviceaccounts,ou=ops,ou=nci,ou=nih,ou=ad,dc=nih,dc=gov',
    vds_pwd: '?wjWEjd-sdjksS[',
    vds_host: 'ldaps://directoryservices.nih.gov:636'
}

async function testGetByIC() {
    initConfiguration(configuration)
    
    try {
        const result = await getUsers('NCI');
        console.info('Result:', result.length);
        console.info(result[0]);
        console.info(result[1]);
        console.info(result[2]);
        console.info('Completed');
    }
    catch (error) {
        console.error(error);
    }
}

testGetByIC();
